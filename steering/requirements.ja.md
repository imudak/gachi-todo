# gachi-todo 要件定義（Phase 1 MVP）

**バージョン**: 1.0.0
**最終更新**: 2026-02-20
**フェーズ**: Phase 1 — ゼロ認知起動 × キャラ完了リアクション

---

## スコープ

**Phase 1 の体験ゴール**:
> 「開いた瞬間に今日のタスクが1つ出てきて、完了したらキャラが喜ぶ」

これ以上の機能は Phase 2 以降で検討する。

---

## 用語定義

| 用語 | 定義 |
|------|------|
| **今日のタスク** | 当日（ローカル時刻）に実施予定のタスク1件 |
| **タスク** | ユーザーが登録する行動単位。目標に紐づける（任意） |
| **目標** | 複数のタスクを束ねる大きな方向性（例: 「英語を話せるようになる」） |
| **キャラクター** | タスク完了に反応して喜ぶアニメーションキャラ |
| **完了リアクション** | タスク完了時にキャラクターが喜ぶアニメーション・エフェクト |

---

## 要件（EARS形式）

### REQ-001: ゼロ認知起動（P14: 迷わない安心感）

#### REQ-001-01: 起動時の今日のタスク表示
- **Ubiquitous**: システムは、アプリ起動時に「今日のタスク」を1件だけホーム画面に表示すること。
- **Event-driven**: ユーザーがアプリを開いた場合、システムは0.5秒以内に今日のタスクを画面に描画すること。
- **State-driven**: 今日のタスクが登録されていない状態で、システムはタスク追加を促すメッセージとボタンを表示すること。
- **State-driven**: 今日のタスクが複数登録されている状態で、システムは最優先の1件のみをホーム画面に表示すること。

#### REQ-001-02: ローディング体験
- **Unwanted behavior**: ネットワーク接続がない場合でも、システムはローカルデータから今日のタスクを表示すること。
- **Ubiquitous**: システムは、データ読み込み中にスケルトンUI（プレースホルダー）を表示すること。

---

### REQ-002: タスク管理

#### REQ-002-01: タスクの登録
- **Event-driven**: ユーザーがタスクを追加した場合、システムはタスクをIndexedDBに保存し、画面を即座に更新すること。
- **Ubiquitous**: システムは、タスクに「タイトル（必須）」「実施予定日（任意）」「紐づける目標（任意）」を持たせること。
- **Unwanted behavior**: ユーザーがタイトルを入力せずに保存しようとした場合、システムは保存をブロックしてエラーを表示すること。

#### REQ-002-02: タスクの完了
- **Event-driven**: ユーザーがタスクを完了操作した場合、システムはタスクを完了状態に更新し、完了リアクションを発火すること。
- **Ubiquitous**: システムは、完了したタスクを「今日のタスク」表示枠から外すこと。
- **State-driven**: 今日のタスクが全て完了している状態で、システムは「今日のタスク完了！」のメッセージとキャラクターの全力喜びアニメーションを表示すること。

#### REQ-002-03: タスクの削除
- **Event-driven**: ユーザーがタスクを削除した場合、システムはIndexedDBからタスクを削除し、画面を更新すること。
- **Event-driven**: ユーザーが削除を操作した場合、システムは確認ダイアログを表示すること。

---

### REQ-003: 目標管理

#### REQ-003-01: 目標の登録
- **Event-driven**: ユーザーが目標を追加した場合、システムは目標をIndexedDBに保存すること。
- **Ubiquitous**: システムは、目標に「タイトル（必須）」を持たせること。

#### REQ-003-02: タスクと目標の紐付け
- **Event-driven**: ユーザーがタスク登録時に目標を選択した場合、システムはタスクと目標を関連付けて保存すること。
- **Ubiquitous**: システムは、目標なしでタスクを登録できること（目標は任意）。

---

### REQ-004: キャラクターリアクション（P2: たまごっち効果）

#### REQ-004-01: 完了リアクション
- **Event-driven**: ユーザーがタスクを完了した場合、システムはキャラクターの喜びアニメーションを0.3秒以内に再生すること。
- **Ubiquitous**: システムは、完了リアクションにCSSアニメーションまたはLottieアニメーションを使用すること。
- **Ubiquitous**: システムは、キャラクターをホーム画面に常時表示すること（待機モーション付き）。

#### REQ-004-02: キャラクターの状態
- **State-driven**: タスクが未完了の状態で、システムはキャラクターを「待機中」の通常モーションで表示すること。
- **State-driven**: タスクを完了した直後の状態で、システムはキャラクターを「喜び」モーションで表示すること（3秒間）。
- **State-driven**: 喜びモーション終了後、システムはキャラクターを待機モーションに戻すこと。

---

### REQ-005: データ永続化

#### REQ-005-01: ローカルストレージ
- **Ubiquitous**: システムは、全データをIndexedDB（ブラウザローカル）に保存すること。
- **Ubiquitous**: システムは、外部サーバーへのデータ送信を行わないこと。
- **Unwanted behavior**: ブラウザが再起動した場合でも、システムはIndexedDBからデータを復元すること。

---

### REQ-006: PWA要件

#### REQ-006-01: インストール可能
- **Ubiquitous**: システムは、PWAとしてホーム画面へのインストールが可能であること（manifest.json 実装）。
- **Ubiquitous**: システムは、Service Workerを実装し、基本的なオフライン動作を保証すること。

#### REQ-006-02: パフォーマンス
- **Ubiquitous**: システムは、初回ロードのLCP（Largest Contentful Paint）を2.5秒以内に収めること。
- **Ubiquitous**: システムは、2回目以降のロードをService Workerキャッシュにより1秒以内に完了すること。

---

## 対象外（Phase 1 スコープ外）

以下は Phase 2 以降で検討する:

- ヒートマップ・年次まとめ（P13: 作品化欲求）
- デイリーチャレンジ（P9: 希少性効果）
- キャラクターのレベルアップ・進化
- プッシュ通知
- タスクの繰り返し設定
- データエクスポート / インポート
- ユーザーアカウント / クラウド同期

---

## 非機能要件（Phase 1）

| 項目 | 要件 |
|------|------|
| **対応ブラウザ** | Chrome / Safari 最新版、Firefox 最新版 |
| **対応デバイス** | モバイルファースト（iOS / Android）、PCも動作すること |
| **アクセシビリティ** | WCAG 2.1 AA 準拠（ボタン・フォームの適切なラベル） |
| **言語** | 日本語のみ（Phase 1） |
| **データサイズ** | IndexedDBの使用量は50MB以下に抑えること |

---

## トレーサビリティマトリクス

| 要件ID | 設計原則 | 動機パターン |
|--------|----------|-------------|
| REQ-001 | ゼロ認知起動 | P14: 迷わない安心感 |
| REQ-002 | ゼロ認知起動 | P14: 迷わない安心感 |
| REQ-003 | ゼロ認知起動 | P3: 前払い進捗効果 |
| REQ-004 | 愛着の対象を作る | P2: たまごっち効果 |
| REQ-005 | — | — |
| REQ-006 | — | — |
